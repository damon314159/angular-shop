<!-- A series of html form inputs, thought each follows a similar pattern -->
<!-- Each contains an input element with relevant aria attributes and validation -->
<!-- Followed by an error container where some ngIf directives show the correct message -->
<h1 mat-dialog-title>Checkout</h1>
<div mat-dialog-content>
  <form #checkoutForm="ngForm">
    <mat-form-field>
      <mat-label for="firstName">First Name</mat-label>
      <input
        matInput
        required
        type="text"
        id="firstName"
        name="firstName"
        #firstName="ngModel"
        [(ngModel)]="data.firstName"
        autocomplete="on"
        maxlength="16"
        [attr.aria-invalid]="firstName.invalid && (firstName.dirty || firstName.touched) ? true : null"
        [attr.aria-describedby]="firstName.invalid && (firstName.dirty || firstName.touched) ? 'firstNameError' : null"
      />
      <mat-error *ngIf="firstName.invalid && (firstName.dirty || firstName.touched)" id="firstNameError">
        <span *ngIf="firstName.errors?.['required']">First Name is required.</span>
        <span *ngIf="!firstName.errors?.['required'] && firstName.errors?.['maxlength']"
          >This field must have at most 16 characters.</span
        >
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="lastName">Last Name</mat-label>
      <input
        matInput
        required
        type="text"
        id="lastName"
        name="lastName"
        #lastName="ngModel"
        [(ngModel)]="data.lastName"
        autocomplete="on"
        maxlength="16"
        [attr.aria-invalid]="lastName.invalid && (lastName.dirty || lastName.touched) ? true : null"
        [attr.aria-describedby]="lastName.invalid && (lastName.dirty || lastName.touched) ? 'lastNameError' : null"
      />
      <mat-error *ngIf="lastName.invalid && (lastName.dirty || lastName.touched)" id="lastNameError">
        <span *ngIf="lastName.errors?.['required']">Last Name is required.</span>
        <span *ngIf="!lastName.errors?.['required'] && lastName.errors?.['maxlength']"
          >This field must have at most 16 characters.</span
        >
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="email">Email</mat-label>
      <input
        matInput
        required
        type="email"
        placeholder="Eg: name@example.com"
        id="email"
        name="email"
        #email="ngModel"
        [(ngModel)]="data.email"
        autocomplete="on"
        emailValidator
        [attr.aria-invalid]="email.invalid && (email.dirty || email.touched) ? true : null"
        [attr.aria-describedby]="email.invalid && (email.dirty || email.touched) ? 'emailError' : null"
      />
      <mat-error *ngIf="email.invalid && (email.dirty || email.touched)" id="emailError">
        <span *ngIf="email.errors?.['required']">Email is required.</span>
        <span *ngIf="!email.errors?.['required'] && email.errors?.['invalidEmail']">Invalid Email format.</span>
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="phoneNumber">Phone Number</mat-label>
      <input
        matInput
        required
        type="tel"
        placeholder="Eg: 07000 123 456"
        id="phoneNumber"
        name="phoneNumber"
        #phoneNumber="ngModel"
        [(ngModel)]="data.phoneNumber"
        autocomplete="on"
        phoneValidator
        [attr.aria-invalid]="phoneNumber.invalid && (phoneNumber.dirty || phoneNumber.touched) ? true : null"
        [attr.aria-describedby]="
          phoneNumber.invalid && (phoneNumber.dirty || phoneNumber.touched) ? 'phoneNumberError' : null
        "
      />
      <mat-error *ngIf="phoneNumber.invalid && (phoneNumber.dirty || phoneNumber.touched)" id="phoneNumberError">
        <span *ngIf="phoneNumber.errors?.['required']">Phone is required.</span>
        <span *ngIf="!phoneNumber.errors?.['required'] && phoneNumber.errors?.['invalidPhoneNumber']"
          >Invalid Phone Number format.</span
        >
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="address1">Address Line 1</mat-label>
      <input
        matInput
        required
        type="text"
        id="address1"
        name="address1"
        #address1="ngModel"
        [(ngModel)]="data.address1"
        autocomplete="on"
        [attr.aria-invalid]="address1.invalid && (address1.dirty || address1.touched) ? true : null"
        [attr.aria-describedby]="address1.invalid && (address1.dirty || address1.touched) ? 'address1Error' : null"
      />
      <mat-error *ngIf="address1.invalid && (address1.dirty || address1.touched)" id="address1Error">
        <span *ngIf="address1.errors?.['required']">Address is required.</span>
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="address2">Address Line 2</mat-label>
      <input
        matInput
        type="text"
        id="address2"
        name="address2"
        #address2="ngModel"
        [(ngModel)]="data.address2"
        autocomplete="on"
      />
    </mat-form-field>

    <mat-form-field>
      <mat-label for="city">City</mat-label>
      <input
        matInput
        required
        type="text"
        id="city"
        name="city"
        #city="ngModel"
        [(ngModel)]="data.city"
        autocomplete="on"
        [attr.aria-invalid]="city.invalid && (city.dirty || city.touched) ? true : null"
        [attr.aria-describedby]="city.invalid && (city.dirty || city.touched) ? 'cityError' : null"
      />
      <mat-error *ngIf="city.invalid && (city.dirty || city.touched)" id="cityError">
        <span *ngIf="city.errors?.['required']">City is required.</span>
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="county">County</mat-label>
      <input
        matInput
        required
        type="text"
        id="county"
        name="county"
        #county="ngModel"
        [(ngModel)]="data.county"
        autocomplete="on"
        maxlength="16"
        [attr.aria-invalid]="county.invalid && (county.dirty || county.touched) ? true : null"
        [attr.aria-describedby]="county.invalid && (county.dirty || county.touched) ? 'countyError' : null"
      />
      <mat-error *ngIf="county.invalid && (county.dirty || county.touched)" id="countyError">
        <span *ngIf="county.errors?.['required']">County is required.</span>
        <span *ngIf="!county.errors?.['required'] && county.errors?.['maxlength']"
          >This field must have at most 16 characters.</span
        >
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="postcode">Postcode</mat-label>
      <input
        matInput
        required
        type="text"
        placeholder="Eg: SW1 1AB"
        id="postcode"
        name="postcode"
        #postcode="ngModel"
        [(ngModel)]="data.postcode"
        autocomplete="on"
        postcodeValidator
        [attr.aria-invalid]="postcode.invalid && (postcode.dirty || postcode.touched) ? true : null"
        [attr.aria-describedby]="postcode.invalid && (postcode.dirty || postcode.touched) ? 'postcodeError' : null"
      />
      <mat-error *ngIf="postcode.invalid && (postcode.dirty || postcode.touched)" id="postcodeError">
        <span *ngIf="postcode.errors?.['required']">Postcode is required.</span>
        <span *ngIf="!postcode.errors?.['required'] && postcode.errors?.['invalidPostcode']"
          >Invalid Postcode format.</span
        >
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="country">Country</mat-label>
      <input
        matInput
        required
        type="text"
        id="country"
        name="country"
        #country="ngModel"
        [(ngModel)]="data.country"
        autocomplete="on"
        maxlength="16"
        [attr.aria-invalid]="country.invalid && (country.dirty || country.touched) ? true : null"
        [attr.aria-describedby]="country.invalid && (country.dirty || country.touched) ? 'countryError' : null"
      />
      <mat-error *ngIf="country.invalid && (country.dirty || country.touched)" id="countryError">
        <span *ngIf="country.errors?.['required']">Country is required.</span>
        <span *ngIf="!country.errors?.['required'] && country.errors?.['maxlength']"
          >This field must have at most 16 characters.</span
        >
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="cardNumber">Card Number</mat-label>
      <input
        matInput
        required
        type="text"
        placeholder="Eg: 1234 5678 8765 4321"
        id="cardNumber"
        name="cardNumber"
        #cardNumber="ngModel"
        [(ngModel)]="data.cardNumber"
        autocomplete="off"
        pattern="^\d{4}(?:\s?\d{4}){3}$"
        [attr.aria-invalid]="cardNumber.invalid && (cardNumber.dirty || cardNumber.touched) ? true : null"
        [attr.aria-describedby]="
          cardNumber.invalid && (cardNumber.dirty || cardNumber.touched) ? 'cardNumberError' : null
        "
      />
      <mat-error *ngIf="cardNumber.invalid && (cardNumber.dirty || cardNumber.touched)" id="cardNumberError">
        <span *ngIf="cardNumber.errors?.['required']">Card number is required.</span>
        <span *ngIf="!cardNumber.errors?.['required'] && cardNumber.errors?.['pattern']"
          >This field must be 16 digits.</span
        >
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="expiry">Expiry</mat-label>
      <input
        matInput
        required
        type="text"
        placeholder="Eg: mm/yy"
        id="expiry"
        name="expiry"
        #expiry="ngModel"
        [(ngModel)]="data.expiry"
        autocomplete="off"
        expiryValidator
        [attr.aria-invalid]="expiry.invalid && (expiry.dirty || expiry.touched) ? true : null"
        [attr.aria-describedby]="expiry.invalid && (expiry.dirty || expiry.touched) ? 'expiryError' : null"
      />
      <mat-error *ngIf="expiry.invalid && (expiry.dirty || expiry.touched)" id="expiryError">
        <span *ngIf="expiry.errors?.['required']">Expiry is required.</span>
        <span *ngIf="!expiry.errors?.['required'] && expiry.errors?.['invalidExpiry']">Invalid Expiry format.</span>
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label for="cvc">CVC</mat-label>
      <input
        matInput
        required
        type="number"
        id="cvc"
        name="cvc"
        #cvc="ngModel"
        [(ngModel)]="data.cvc"
        autocomplete="off"
        pattern="\d{3,4}"
        [attr.aria-invalid]="cvc.invalid && (cvc.dirty || cvc.touched) ? true : null"
        [attr.aria-describedby]="cvc.invalid && (cvc.dirty || cvc.touched) ? 'cvcError' : null"
      />
      <mat-error *ngIf="cvc.invalid && (cvc.dirty || cvc.touched)" id="cvcError">
        <span *ngIf="cvc.errors?.['required']">CVC is required.</span>
        <span *ngIf="!cvc.errors?.['required'] && cvc.errors?.['pattern']">This field must have 3-4 digits.</span>
      </mat-error>
    </mat-form-field>
  </form>
</div>

<!-- Small button panel to exit or submit the form -->
<div mat-dialog-actions>
  <button mat-button (click)="onCancelClick()">Cancel</button>
  <button mat-button (click)="submitForm()" cdkFocusInitial type="submit">Submit</button>
</div>
